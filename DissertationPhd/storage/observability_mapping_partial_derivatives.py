from numpy import sqrt, sin, cos
import numpy as np

def h_element(i_x, i_y, i_n, i, j, i_all, j_all, fn, cn, relation, angles_navigation, r1, r2, r_f, q_f, multy_antenna_send: bool, multy_antenna_take: bool, q1: None, q2: None):
    '''Возвращает элемент матрицы Н в L_z^(c/d) строк и 6/13 столбцов.
    Столбец элемента матрицы H определяет только i_x. Остальные параметры определяют строку.
    :param i_x: Номер чипсата, у которого оценивается вектор-состояние (N вширь всей матрицы H)
    :param i_y: Номер чипсата/кубсата, от которого идёт сигнал (M / N(N-1) ввысь половины матрицы H)
    :param i_n: Номер чипсата, к которому идёт сигнал N ввысь элемента матрицы H^cf/H^ff)
    :param i: Номер 1-го КА
    :param j: Номер 2-го КА
    :param fn: Количество чипсатов
    :param cn: Количество кубсатов
    :param i_all: Количество антенн у 1-го КА
    :param j_all: Количество антенн у 2-го КА
    :param relation: Блок кубат-чипсат (cf) или чипсат-чипсат (ff) 
    :param angles_navigation: Оценивается ли вращательное движение
    :param r1: Положение 1-го КА
    :param r2: Положение 2-го КА
    :param r_f: Положения чипсатов
    :param q_f: Кватернионы ориентации чипсатов
    :param multy_antenna_send: Раскладывается ли сигнал при отправке
    :param multy_antenna_take: Раскладывается ли сигнал при принятии
    :param q1: Кватернион 1-го КА (опционально)
    :param q2: Кватернион 2-го КА (опционально)
    '''

    ff_sequence = []  # Последовательность номеров непустых столбцов, длина ff_sequence - кол-во строк нижней подматицы
    for i_f1 in range(fn):
        for i_f2 in range(i_f1):
            if i_f1 != i_f2:
                ff_sequence += [[i_f1, i_f2]]

    r1_x, r1_y, r1_z = r1
    r2_x, r2_y, r2_z = r2

    if (angles_navigation==False) and (i_all==0) and (j_all==0) and (multy_antenna_send==False) and (multy_antenna_take==False) and (relation=='cf'):
        return np.array([
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==0) and (j_all==0) and (multy_antenna_send==False) and (multy_antenna_take==False) and (relation=='ff'):
        return np.array([
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==0) and (j_all==0) and (multy_antenna_send==False) and (multy_antenna_take==True) and (relation=='cf'):
        return np.array([
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==0) and (j_all==0) and (multy_antenna_send==False) and (multy_antenna_take==True) and (relation=='ff'):
        return np.array([
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==0) and (j_all==0) and (multy_antenna_send==True) and (multy_antenna_take==False) and (relation=='cf'):
        return np.array([
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==0) and (j_all==0) and (multy_antenna_send==True) and (multy_antenna_take==False) and (relation=='ff'):
        return np.array([
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==0) and (j_all==0) and (multy_antenna_send==True) and (multy_antenna_take==True) and (relation=='cf'):
        return np.array([
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==0) and (j_all==0) and (multy_antenna_send==True) and (multy_antenna_take==True) and (relation=='ff'):
        return np.array([
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==0) and (j_all==1) and (multy_antenna_send==False) and (multy_antenna_take==False) and (relation=='cf'):
        return np.array([
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==0) and (j_all==1) and (multy_antenna_send==False) and (multy_antenna_take==False) and (relation=='ff'):
        return np.array([
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==0) and (j_all==1) and (multy_antenna_send==False) and (multy_antenna_take==True) and (relation=='cf'):
        return np.array([
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==0) and (j_all==1) and (multy_antenna_send==False) and (multy_antenna_take==True) and (relation=='ff'):
        return np.array([
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==0) and (j_all==1) and (multy_antenna_send==True) and (multy_antenna_take==False) and (relation=='cf'):
        return np.array([
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==0) and (j_all==1) and (multy_antenna_send==True) and (multy_antenna_take==False) and (relation=='ff'):
        return np.array([
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==0) and (j_all==1) and (multy_antenna_send==True) and (multy_antenna_take==True) and (relation=='cf'):
        return np.array([
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==0) and (j_all==1) and (multy_antenna_send==True) and (multy_antenna_take==True) and (relation=='ff'):
        return np.array([
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==0) and (j_all==2) and (multy_antenna_send==False) and (multy_antenna_take==False) and (relation=='cf'):
        return np.array([
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==0) and (j_all==2) and (multy_antenna_send==False) and (multy_antenna_take==False) and (relation=='ff'):
        return np.array([
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==0) and (j_all==2) and (multy_antenna_send==False) and (multy_antenna_take==True) and (relation=='cf'):
        return np.array([
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==0) and (j_all==2) and (multy_antenna_send==False) and (multy_antenna_take==True) and (relation=='ff'):
        return np.array([
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==0) and (j_all==2) and (multy_antenna_send==True) and (multy_antenna_take==False) and (relation=='cf'):
        return np.array([
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==0) and (j_all==2) and (multy_antenna_send==True) and (multy_antenna_take==False) and (relation=='ff'):
        return np.array([
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==0) and (j_all==2) and (multy_antenna_send==True) and (multy_antenna_take==True) and (relation=='cf'):
        return np.array([
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==0) and (j_all==2) and (multy_antenna_send==True) and (multy_antenna_take==True) and (relation=='ff'):
        return np.array([
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==1) and (j_all==0) and (multy_antenna_send==False) and (multy_antenna_take==False) and (relation=='cf'):
        return np.array([
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==1) and (j_all==0) and (multy_antenna_send==False) and (multy_antenna_take==False) and (relation=='ff'):
        return np.array([
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==1) and (j_all==0) and (multy_antenna_send==False) and (multy_antenna_take==True) and (relation=='cf'):
        return np.array([
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==1) and (j_all==0) and (multy_antenna_send==False) and (multy_antenna_take==True) and (relation=='ff'):
        return np.array([
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==1) and (j_all==0) and (multy_antenna_send==True) and (multy_antenna_take==False) and (relation=='cf'):
        return np.array([
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==1) and (j_all==0) and (multy_antenna_send==True) and (multy_antenna_take==False) and (relation=='ff'):
        return np.array([
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==1) and (j_all==0) and (multy_antenna_send==True) and (multy_antenna_take==True) and (relation=='cf'):
        return np.array([
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==1) and (j_all==0) and (multy_antenna_send==True) and (multy_antenna_take==True) and (relation=='ff'):
        return np.array([
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==1) and (j_all==1) and (multy_antenna_send==False) and (multy_antenna_take==False) and (relation=='cf'):
        return np.array([
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==1) and (j_all==1) and (multy_antenna_send==False) and (multy_antenna_take==False) and (relation=='ff'):
        return np.array([
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==1) and (j_all==1) and (multy_antenna_send==False) and (multy_antenna_take==True) and (relation=='cf'):
        return np.array([
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==1) and (j_all==1) and (multy_antenna_send==False) and (multy_antenna_take==True) and (relation=='ff'):
        return np.array([
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==1) and (j_all==1) and (multy_antenna_send==True) and (multy_antenna_take==False) and (relation=='cf'):
        return np.array([
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==1) and (j_all==1) and (multy_antenna_send==True) and (multy_antenna_take==False) and (relation=='ff'):
        return np.array([
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==1) and (j_all==1) and (multy_antenna_send==True) and (multy_antenna_take==True) and (relation=='cf'):
        return np.array([
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==1) and (j_all==1) and (multy_antenna_send==True) and (multy_antenna_take==True) and (relation=='ff'):
        return np.array([
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==1) and (j_all==2) and (multy_antenna_send==False) and (multy_antenna_take==False) and (relation=='cf'):
        return np.array([
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==1) and (j_all==2) and (multy_antenna_send==False) and (multy_antenna_take==False) and (relation=='ff'):
        return np.array([
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==1) and (j_all==2) and (multy_antenna_send==False) and (multy_antenna_take==True) and (relation=='cf'):
        return np.array([
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==1) and (j_all==2) and (multy_antenna_send==False) and (multy_antenna_take==True) and (relation=='ff'):
        return np.array([
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==1) and (j_all==2) and (multy_antenna_send==True) and (multy_antenna_take==False) and (relation=='cf'):
        return np.array([
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==1) and (j_all==2) and (multy_antenna_send==True) and (multy_antenna_take==False) and (relation=='ff'):
        return np.array([
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==1) and (j_all==2) and (multy_antenna_send==True) and (multy_antenna_take==True) and (relation=='cf'):
        return np.array([
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==1) and (j_all==2) and (multy_antenna_send==True) and (multy_antenna_take==True) and (relation=='ff'):
        return np.array([
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==2) and (j_all==0) and (multy_antenna_send==False) and (multy_antenna_take==False) and (relation=='cf'):
        return np.array([
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==2) and (j_all==0) and (multy_antenna_send==False) and (multy_antenna_take==False) and (relation=='ff'):
        return np.array([
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==2) and (j_all==0) and (multy_antenna_send==False) and (multy_antenna_take==True) and (relation=='cf'):
        return np.array([
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==2) and (j_all==0) and (multy_antenna_send==False) and (multy_antenna_take==True) and (relation=='ff'):
        return np.array([
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==2) and (j_all==0) and (multy_antenna_send==True) and (multy_antenna_take==False) and (relation=='cf'):
        return np.array([
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==2) and (j_all==0) and (multy_antenna_send==True) and (multy_antenna_take==False) and (relation=='ff'):
        return np.array([
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==2) and (j_all==0) and (multy_antenna_send==True) and (multy_antenna_take==True) and (relation=='cf'):
        return np.array([
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==2) and (j_all==0) and (multy_antenna_send==True) and (multy_antenna_take==True) and (relation=='ff'):
        return np.array([
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==2) and (j_all==1) and (multy_antenna_send==False) and (multy_antenna_take==False) and (relation=='cf'):
        return np.array([
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==2) and (j_all==1) and (multy_antenna_send==False) and (multy_antenna_take==False) and (relation=='ff'):
        return np.array([
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==2) and (j_all==1) and (multy_antenna_send==False) and (multy_antenna_take==True) and (relation=='cf'):
        return np.array([
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==2) and (j_all==1) and (multy_antenna_send==False) and (multy_antenna_take==True) and (relation=='ff'):
        return np.array([
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==2) and (j_all==1) and (multy_antenna_send==True) and (multy_antenna_take==False) and (relation=='cf'):
        return np.array([
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==2) and (j_all==1) and (multy_antenna_send==True) and (multy_antenna_take==False) and (relation=='ff'):
        return np.array([
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==2) and (j_all==1) and (multy_antenna_send==True) and (multy_antenna_take==True) and (relation=='cf'):
        return np.array([
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==2) and (j_all==1) and (multy_antenna_send==True) and (multy_antenna_take==True) and (relation=='ff'):
        return np.array([
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==2) and (j_all==2) and (multy_antenna_send==False) and (multy_antenna_take==False) and (relation=='cf'):
        return np.array([
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==2) and (j_all==2) and (multy_antenna_send==False) and (multy_antenna_take==False) and (relation=='ff'):
        return np.array([
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==2) and (j_all==2) and (multy_antenna_send==False) and (multy_antenna_take==True) and (relation=='cf'):
        return np.array([
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==2) and (j_all==2) and (multy_antenna_send==False) and (multy_antenna_take==True) and (relation=='ff'):
        return np.array([
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==2) and (j_all==2) and (multy_antenna_send==True) and (multy_antenna_take==False) and (relation=='cf'):
        return np.array([
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==2) and (j_all==2) and (multy_antenna_send==True) and (multy_antenna_take==False) and (relation=='ff'):
        return np.array([
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==2) and (j_all==2) and (multy_antenna_send==True) and (multy_antenna_take==True) and (relation=='cf'):
        return np.array([
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==2) and (j_all==2) and (multy_antenna_send==True) and (multy_antenna_take==True) and (relation=='ff'):
        return np.array([
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r1_x - r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_x + r2_x)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_y - r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_y + r2_y)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ((r1_z - r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][0]==i_x)+((-r1_z + r2_z)/sqrt((r1_x - r2_x)**2 + (r1_y - r2_y)**2 + (r1_z - r2_z)**2))*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       ])

    if (angles_navigation==True) and (i_all==0) and (j_all==0) and (multy_antenna_send==False) and (multy_antenna_take==False) and (relation=='cf'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==0) and (j_all==0) and (multy_antenna_send==False) and (multy_antenna_take==False) and (relation=='ff'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==0) and (j_all==0) and (multy_antenna_send==False) and (multy_antenna_take==True) and (relation=='cf'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==0) and (j_all==0) and (multy_antenna_send==False) and (multy_antenna_take==True) and (relation=='ff'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==0) and (j_all==0) and (multy_antenna_send==True) and (multy_antenna_take==False) and (relation=='cf'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==0) and (j_all==0) and (multy_antenna_send==True) and (multy_antenna_take==False) and (relation=='ff'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==0) and (j_all==0) and (multy_antenna_send==True) and (multy_antenna_take==True) and (relation=='cf'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==0) and (j_all==0) and (multy_antenna_send==True) and (multy_antenna_take==True) and (relation=='ff'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==0) and (j_all==1) and (multy_antenna_send==False) and (multy_antenna_take==False) and (relation=='cf'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==0) and (j_all==1) and (multy_antenna_send==False) and (multy_antenna_take==False) and (relation=='ff'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==0) and (j_all==1) and (multy_antenna_send==False) and (multy_antenna_take==True) and (relation=='cf'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==0) and (j_all==1) and (multy_antenna_send==False) and (multy_antenna_take==True) and (relation=='ff'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==0) and (j_all==1) and (multy_antenna_send==True) and (multy_antenna_take==False) and (relation=='cf'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==0) and (j_all==1) and (multy_antenna_send==True) and (multy_antenna_take==False) and (relation=='ff'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==0) and (j_all==1) and (multy_antenna_send==True) and (multy_antenna_take==True) and (relation=='cf'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==0) and (j_all==1) and (multy_antenna_send==True) and (multy_antenna_take==True) and (relation=='ff'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==0) and (j_all==2) and (multy_antenna_send==False) and (multy_antenna_take==False) and (relation=='cf'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==0) and (j_all==2) and (multy_antenna_send==False) and (multy_antenna_take==False) and (relation=='ff'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==0) and (j_all==2) and (multy_antenna_send==False) and (multy_antenna_take==True) and (relation=='cf'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==0) and (j_all==2) and (multy_antenna_send==False) and (multy_antenna_take==True) and (relation=='ff'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==0) and (j_all==2) and (multy_antenna_send==True) and (multy_antenna_take==False) and (relation=='cf'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==0) and (j_all==2) and (multy_antenna_send==True) and (multy_antenna_take==False) and (relation=='ff'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==0) and (j_all==2) and (multy_antenna_send==True) and (multy_antenna_take==True) and (relation=='cf'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==0) and (j_all==2) and (multy_antenna_send==True) and (multy_antenna_take==True) and (relation=='ff'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==1) and (j_all==0) and (multy_antenna_send==False) and (multy_antenna_take==False) and (relation=='cf'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==1) and (j_all==0) and (multy_antenna_send==False) and (multy_antenna_take==False) and (relation=='ff'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==1) and (j_all==0) and (multy_antenna_send==False) and (multy_antenna_take==True) and (relation=='cf'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==1) and (j_all==0) and (multy_antenna_send==False) and (multy_antenna_take==True) and (relation=='ff'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==1) and (j_all==0) and (multy_antenna_send==True) and (multy_antenna_take==False) and (relation=='cf'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==1) and (j_all==0) and (multy_antenna_send==True) and (multy_antenna_take==False) and (relation=='ff'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==1) and (j_all==0) and (multy_antenna_send==True) and (multy_antenna_take==True) and (relation=='cf'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==1) and (j_all==0) and (multy_antenna_send==True) and (multy_antenna_take==True) and (relation=='ff'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==1) and (j_all==1) and (multy_antenna_send==False) and (multy_antenna_take==False) and (relation=='cf'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==1) and (j_all==1) and (multy_antenna_send==False) and (multy_antenna_take==False) and (relation=='ff'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==1) and (j_all==1) and (multy_antenna_send==False) and (multy_antenna_take==True) and (relation=='cf'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==1) and (j_all==1) and (multy_antenna_send==False) and (multy_antenna_take==True) and (relation=='ff'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==1) and (j_all==1) and (multy_antenna_send==True) and (multy_antenna_take==False) and (relation=='cf'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==1) and (j_all==1) and (multy_antenna_send==True) and (multy_antenna_take==False) and (relation=='ff'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==1) and (j_all==1) and (multy_antenna_send==True) and (multy_antenna_take==True) and (relation=='cf'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==1) and (j_all==1) and (multy_antenna_send==True) and (multy_antenna_take==True) and (relation=='ff'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==1) and (j_all==2) and (multy_antenna_send==False) and (multy_antenna_take==False) and (relation=='cf'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==1) and (j_all==2) and (multy_antenna_send==False) and (multy_antenna_take==False) and (relation=='ff'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==1) and (j_all==2) and (multy_antenna_send==False) and (multy_antenna_take==True) and (relation=='cf'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==1) and (j_all==2) and (multy_antenna_send==False) and (multy_antenna_take==True) and (relation=='ff'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==1) and (j_all==2) and (multy_antenna_send==True) and (multy_antenna_take==False) and (relation=='cf'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==1) and (j_all==2) and (multy_antenna_send==True) and (multy_antenna_take==False) and (relation=='ff'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==1) and (j_all==2) and (multy_antenna_send==True) and (multy_antenna_take==True) and (relation=='cf'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==1) and (j_all==2) and (multy_antenna_send==True) and (multy_antenna_take==True) and (relation=='ff'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==2) and (j_all==0) and (multy_antenna_send==False) and (multy_antenna_take==False) and (relation=='cf'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==2) and (j_all==0) and (multy_antenna_send==False) and (multy_antenna_take==False) and (relation=='ff'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==2) and (j_all==0) and (multy_antenna_send==False) and (multy_antenna_take==True) and (relation=='cf'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==2) and (j_all==0) and (multy_antenna_send==False) and (multy_antenna_take==True) and (relation=='ff'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==2) and (j_all==0) and (multy_antenna_send==True) and (multy_antenna_take==False) and (relation=='cf'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==2) and (j_all==0) and (multy_antenna_send==True) and (multy_antenna_take==False) and (relation=='ff'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==2) and (j_all==0) and (multy_antenna_send==True) and (multy_antenna_take==True) and (relation=='cf'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==2) and (j_all==0) and (multy_antenna_send==True) and (multy_antenna_take==True) and (relation=='ff'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==2) and (j_all==1) and (multy_antenna_send==False) and (multy_antenna_take==False) and (relation=='cf'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==2) and (j_all==1) and (multy_antenna_send==False) and (multy_antenna_take==False) and (relation=='ff'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==2) and (j_all==1) and (multy_antenna_send==False) and (multy_antenna_take==True) and (relation=='cf'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==2) and (j_all==1) and (multy_antenna_send==False) and (multy_antenna_take==True) and (relation=='ff'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==2) and (j_all==1) and (multy_antenna_send==True) and (multy_antenna_take==False) and (relation=='cf'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==2) and (j_all==1) and (multy_antenna_send==True) and (multy_antenna_take==False) and (relation=='ff'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==2) and (j_all==1) and (multy_antenna_send==True) and (multy_antenna_take==True) and (relation=='cf'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==2) and (j_all==1) and (multy_antenna_send==True) and (multy_antenna_take==True) and (relation=='ff'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==2) and (j_all==2) and (multy_antenna_send==False) and (multy_antenna_take==False) and (relation=='cf'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==2) and (j_all==2) and (multy_antenna_send==False) and (multy_antenna_take==False) and (relation=='ff'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==2) and (j_all==2) and (multy_antenna_send==False) and (multy_antenna_take==True) and (relation=='cf'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==2) and (j_all==2) and (multy_antenna_send==False) and (multy_antenna_take==True) and (relation=='ff'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==2) and (j_all==2) and (multy_antenna_send==True) and (multy_antenna_take==False) and (relation=='cf'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==2) and (j_all==2) and (multy_antenna_send==True) and (multy_antenna_take==False) and (relation=='ff'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==2) and (j_all==2) and (multy_antenna_send==True) and (multy_antenna_take==True) and (relation=='cf'):
        return np.array([
                       ])

    if (angles_navigation==True) and (i_all==2) and (j_all==2) and (multy_antenna_send==True) and (multy_antenna_take==True) and (relation=='ff'):
        return np.array([
                       ])


def h_matrix(c_ant, f_ant, fn, cn, angles_navigation, r_f, r_c, multy_antenna_send: bool, multy_antenna_take: bool, q_f: None, q_c: None) -> np.ndarray:
    '''Возвращает матрицу частных производных Н.
    :param c_ant: Количество антенн у кубсата
    :param f_ant: Количество антенн у чипсата
    :param fn: Количество чипсатов
    :param cn: Количество кубсатов
    :param angles_navigation: Оценивается ли вращательное движение
    :param r_f: Положения чипсатов
    :param r_c: Положения кубсатов
    :param multy_antenna_send: Раскладывается ли сигнал при отправке
    :param multy_antenna_take: Раскладывается ли сигнал при принятии
    :param q_f: Кватернионы чипсатов (опционально)
    :param q_c: Кватернионы кубсатов (опционально)
    :return: Матрица частных производных H. Отображение состояния в измерения
    '''
    ff_sequence = []  # Последовательность номеров непустых столбцов, длина ff_sequence - кол-во строк нижней подматицы
    for i_f1 in range(fn):
        for i_f2 in range(fn):
            if i_f1 != i_f2:
                ff_sequence += [[i_f1, i_f2]]
    cf_matrix = np.array([])
    ff_matrix = np.array([])
    for relation in ['cf', 'ff']:
        tmp_rows = None
        height = cn if relation=='cf' else int(fn*(fn-1)/2)
        for i_y in range(height):
            tmp_row = []
            for i_x in range(fn):
                tmp_row_col = []
                for i_f in range(fn if relation=='cf' else 1):
                    if relation == 'cf':
                        i_1 = i_y
                        i_2 = i_f
                    else:
                        i_1 = ff_sequence[i_y][0]
                        i_2 = ff_sequence[i_y][1]
                    tmp_row_col += [h_element(i_x=i_x, i_y=i_y, i_n=i_f, i=i_1, j=i_2, i_all=c_ant if relation=='cf' else f_ant, j_all=f_ant, fn=fn, cn=cn, relation=relation, angles_navigation=angles_navigation, r_f=r_f, r1=r_c[i_1] if relation=='cf' else r_f[i_1], r2=r_f[i_2], q_f=q_f, q1=q_c[i_1] if relation=='cf' else q_f[i_1], q2=q_f[i_2], multy_antenna_send=multy_antenna_send, multy_antenna_take=multy_antenna_take)]
                    
                tmp_row += [np.vstack(tmp_row_col)]
            
            tmp_row = np.bmat(tmp_row)
            tmp_rows = tmp_row if tmp_rows is None else np.vstack([tmp_rows, tmp_row])
        
        if relation == 'cf':
            cf_matrix = tmp_rows
        else:
            ff_matrix = tmp_rows
    
    print('Верхняя подматрица: ' + str(cf_matrix.shape))
    if ff_matrix is not None:
        print('Нижняя подматрица: ' + str(ff_matrix.shape))
        return np.vstack([cf_matrix, ff_matrix]), cf_matrix, ff_matrix
    return cf_matrix, cf_matrix, None
